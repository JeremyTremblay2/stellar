<Window
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:Appli"
        xmlns:usersControls="clr-namespace:Appli.usersControls" 
        xmlns:espace="clr-namespace:Espace;assembly=Modele" x:Class="Appli.MainWindow"
        mc:Ignorable="d"
        Title="Stellar" Height="600" Width="1100">

    <Window.Resources>
        <DataTemplate x:Key="astreTemplate">
            <usersControls:UCImageAstre ImageAstre="{Binding Image}"/>
        </DataTemplate>

        <DataTemplate DataType="{x:Type espace:Etoile}">
            <Grid Background="Transparent" MouseLeftButtonDown="popupClicMenu">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <ContentPresenter DockPanel.Dock="Left" Content="{Binding}" ContentTemplate="{StaticResource astreTemplate}" />

                <StackPanel Grid.Column="1">
                    <TextBlock Style="{StaticResource texteNomAstre}" Foreground="Orange">
                        <Run Text="{Binding Nom, Mode=OneWay}" />
                        <Run Text="" x:Name="personnalise" />
                    </TextBlock>
                    <TextBlock Style="{StaticResource texteInfosAstre}">
                        <Run Text="{Binding Age, Mode=OneWay}"/>
                        <Run Text=" an(s)."/>
                    </TextBlock>
                    <TextBlock Style="{StaticResource texteInfosAstre}">
                        <Run Text="Dans la constellation " />
                        <Run Text="{Binding Constellation, Mode=OneWay}" />
                    </TextBlock>
                    <TextBlock Style="{StaticResource texteInfosAstre}">
                        <Run Text="Etoile de type "/>
                        <Run Text="{Binding Type, Mode=OneWay}"/>
                    </TextBlock>
                </StackPanel>

                <Button Grid.Column="2" DockPanel.Dock="Right" Click="ModifierFavori"  MouseEnter="SurvolBouton" 
                        MouseLeave="FinSurvolBouton">
                    <Button.Content >
                        <Path Style="{StaticResource PathPopup}" MaxWidth="30" MaxHeight="25" x:Name="favori" Data="m256 455.515625c-7.289062 0-14.316406-2.640625-19.792969-7.4375-20.683593-18.085937-40.625-35.082031-58.21875-50.074219l-.089843-.078125c-51.582032-43.957031-96.125-81.917969-127.117188-119.3125-34.644531-41.804687-50.78125-81.441406-50.78125-124.742187 0-42.070313 14.425781-80.882813 40.617188-109.292969 26.503906-28.746094 62.871093-44.578125 102.414062-44.578125 29.554688 0 56.621094 9.34375 80.445312 27.769531 12.023438 9.300781 22.921876 20.683594 32.523438 33.960938 9.605469-13.277344 20.5-24.660157 32.527344-33.960938 23.824218-18.425781 50.890625-27.769531 80.445312-27.769531 39.539063 0 75.910156 15.832031 102.414063 44.578125 26.191406 28.410156 40.613281 67.222656 40.613281 109.292969 0 43.300781-16.132812 82.9375-50.777344 124.738281-30.992187 37.398437-75.53125 75.355469-127.105468 119.308594-17.625 15.015625-37.597657 32.039062-58.328126 50.167969-5.472656 4.789062-12.503906 7.429687-19.789062 7.429687zm-112.96875-425.523437c-31.066406 0-59.605469 12.398437-80.367188 34.914062-21.070312 22.855469-32.675781 54.449219-32.675781 88.964844 0 36.417968 13.535157 68.988281 43.882813 105.605468 29.332031 35.394532 72.960937 72.574219 123.476562 115.625l.09375.078126c17.660156 15.050781 37.679688 32.113281 58.515625 50.332031 20.960938-18.253907 41.011719-35.34375 58.707031-50.417969 50.511719-43.050781 94.136719-80.222656 123.46875-115.617188 30.34375-36.617187 43.878907-69.1875 43.878907-105.605468 0-34.515625-11.605469-66.109375-32.675781-88.964844-20.757813-22.515625-49.300782-34.914062-80.363282-34.914062-22.757812 0-43.652344 7.234374-62.101562 21.5-16.441406 12.71875-27.894532 28.796874-34.609375 40.046874-3.453125 5.785157-9.53125 9.238282-16.261719 9.238282s-12.808594-3.453125-16.261719-9.238282c-6.710937-11.25-18.164062-27.328124-34.609375-40.046874-18.449218-14.265626-39.34375-21.5-62.097656-21.5zm0 0"/>
                    </Button.Content>
                </Button>
            </Grid>
            <DataTemplate.Triggers>
                <DataTrigger Binding="{Binding Path=Favori}" Value="true">
                    <Setter TargetName="favori" Property="Data" Value="m471.382812 44.578125c-26.503906-28.746094-62.871093-44.578125-102.410156-44.578125-29.554687 0-56.621094 9.34375-80.449218 27.769531-12.023438 9.300781-22.917969 20.679688-32.523438 33.960938-9.601562-13.277344-20.5-24.660157-32.527344-33.960938-23.824218-18.425781-50.890625-27.769531-80.445312-27.769531-39.539063 0-75.910156 15.832031-102.414063 44.578125-26.1875 28.410156-40.613281 67.222656-40.613281 109.292969 0 43.300781 16.136719 82.9375 50.78125 124.742187 30.992188 37.394531 75.535156 75.355469 127.117188 119.3125 17.613281 15.011719 37.578124 32.027344 58.308593 50.152344 5.476563 4.796875 12.503907 7.4375 19.792969 7.4375 7.285156 0 14.316406-2.640625 19.785156-7.429687 20.730469-18.128907 40.707032-35.152344 58.328125-50.171876 51.574219-43.949218 96.117188-81.90625 127.109375-119.304687 34.644532-41.800781 50.777344-81.4375 50.777344-124.742187 0-42.066407-14.425781-80.878907-40.617188-109.289063zm0 0"/>
                    <Setter TargetName="favori" Property="Fill" Value="Red"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding Path=Personnalise}" Value="true">
                    <Setter TargetName="personnalise" Property="Text" Value=" (Personnalisé)"/>
                </DataTrigger>
            </DataTemplate.Triggers>
        </DataTemplate>

        <DataTemplate DataType="{x:Type espace:Planete}">
            <Grid Background="Transparent" MouseLeftButtonDown="popupClicMenu">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <ContentPresenter Content="{Binding}" ContentTemplate="{StaticResource astreTemplate}" />

                <StackPanel Grid.Column="1">
                    <TextBlock Style="{StaticResource texteNomAstre}" Foreground="DarkGreen">
                        <Run Text="{Binding Nom, Mode=OneWay}" />
                        <Run Text="" x:Name="personnalise" />
                    </TextBlock>
                    <TextBlock Style="{StaticResource texteInfosAstre}">
                        <Run Text="{Binding Age, Mode=OneWay}"/>
                        <Run Text=" an(s)."/>
                    </TextBlock>
                    <TextBlock Style="{StaticResource texteInfosAstre}">
                        <Run Text="Dans le système " />
                        <Run Text="{Binding Systeme, Mode=OneWay}" />
                    </TextBlock>
                    <TextBlock  Style="{StaticResource texteInfosAstre}">
                        <Run Text="Planète de type " />
                        <Run Text="{Binding Type, Mode=OneWay}"/>
                    </TextBlock>
                </StackPanel>

                <Button Grid.Column="2" DockPanel.Dock="Right" Click="ModifierFavori"  MouseEnter="SurvolBouton" 
                        MouseLeave="FinSurvolBouton">
                    <Button.Content >
                        <Path Style="{StaticResource PathPopup}" MaxWidth="30" MaxHeight="25" x:Name="favori" Data="m256 455.515625c-7.289062 0-14.316406-2.640625-19.792969-7.4375-20.683593-18.085937-40.625-35.082031-58.21875-50.074219l-.089843-.078125c-51.582032-43.957031-96.125-81.917969-127.117188-119.3125-34.644531-41.804687-50.78125-81.441406-50.78125-124.742187 0-42.070313 14.425781-80.882813 40.617188-109.292969 26.503906-28.746094 62.871093-44.578125 102.414062-44.578125 29.554688 0 56.621094 9.34375 80.445312 27.769531 12.023438 9.300781 22.921876 20.683594 32.523438 33.960938 9.605469-13.277344 20.5-24.660157 32.527344-33.960938 23.824218-18.425781 50.890625-27.769531 80.445312-27.769531 39.539063 0 75.910156 15.832031 102.414063 44.578125 26.191406 28.410156 40.613281 67.222656 40.613281 109.292969 0 43.300781-16.132812 82.9375-50.777344 124.738281-30.992187 37.398437-75.53125 75.355469-127.105468 119.308594-17.625 15.015625-37.597657 32.039062-58.328126 50.167969-5.472656 4.789062-12.503906 7.429687-19.789062 7.429687zm-112.96875-425.523437c-31.066406 0-59.605469 12.398437-80.367188 34.914062-21.070312 22.855469-32.675781 54.449219-32.675781 88.964844 0 36.417968 13.535157 68.988281 43.882813 105.605468 29.332031 35.394532 72.960937 72.574219 123.476562 115.625l.09375.078126c17.660156 15.050781 37.679688 32.113281 58.515625 50.332031 20.960938-18.253907 41.011719-35.34375 58.707031-50.417969 50.511719-43.050781 94.136719-80.222656 123.46875-115.617188 30.34375-36.617187 43.878907-69.1875 43.878907-105.605468 0-34.515625-11.605469-66.109375-32.675781-88.964844-20.757813-22.515625-49.300782-34.914062-80.363282-34.914062-22.757812 0-43.652344 7.234374-62.101562 21.5-16.441406 12.71875-27.894532 28.796874-34.609375 40.046874-3.453125 5.785157-9.53125 9.238282-16.261719 9.238282s-12.808594-3.453125-16.261719-9.238282c-6.710937-11.25-18.164062-27.328124-34.609375-40.046874-18.449218-14.265626-39.34375-21.5-62.097656-21.5zm0 0"/>
                    </Button.Content>
                </Button>
            </Grid>
            <DataTemplate.Triggers>
                <DataTrigger Binding="{Binding Path=Favori}" Value="true">
                    <Setter TargetName="favori" Property="Data" Value="m471.382812 44.578125c-26.503906-28.746094-62.871093-44.578125-102.410156-44.578125-29.554687 0-56.621094 9.34375-80.449218 27.769531-12.023438 9.300781-22.917969 20.679688-32.523438 33.960938-9.601562-13.277344-20.5-24.660157-32.527344-33.960938-23.824218-18.425781-50.890625-27.769531-80.445312-27.769531-39.539063 0-75.910156 15.832031-102.414063 44.578125-26.1875 28.410156-40.613281 67.222656-40.613281 109.292969 0 43.300781 16.136719 82.9375 50.78125 124.742187 30.992188 37.394531 75.535156 75.355469 127.117188 119.3125 17.613281 15.011719 37.578124 32.027344 58.308593 50.152344 5.476563 4.796875 12.503907 7.4375 19.792969 7.4375 7.285156 0 14.316406-2.640625 19.785156-7.429687 20.730469-18.128907 40.707032-35.152344 58.328125-50.171876 51.574219-43.949218 96.117188-81.90625 127.109375-119.304687 34.644532-41.800781 50.777344-81.4375 50.777344-124.742187 0-42.066407-14.425781-80.878907-40.617188-109.289063zm0 0"/>
                    <Setter TargetName="favori" Property="Fill" Value="Red"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding Path=Personnalise}" Value="true">
                    <Setter TargetName="personnalise" Property="Text" Value=" (Personnalisé)"/>
                </DataTrigger>
            </DataTemplate.Triggers>
        </DataTemplate>

        <ControlTemplate x:Key="TextBoxRecherche" TargetType="{x:Type TextBoxBase}">
            <Border Background="{TemplateBinding Background}" x:Name="Bordure" BorderBrush="Black"
                BorderThickness="{TemplateBinding BorderThickness}" CornerRadius="10">
                <ScrollViewer x:Name="PART_ContentHost"/>
            </Border>
            <ControlTemplate.Triggers>
                <Trigger Property="IsEnabled" Value="False">
                    <Setter Property="Background" Value="{DynamicResource {x:Static SystemColors.ControlBrushKey}}" TargetName="Bordure"/>
                    <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"/>
                </Trigger>
            </ControlTemplate.Triggers>
        </ControlTemplate>
    </Window.Resources>


    <Grid FocusManager.FocusedElement="{Binding ElementName=BarreRecherche}">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="350" x:Name="MasterGrid"/>
            <ColumnDefinition Width="8*" />
        </Grid.ColumnDefinitions>

        <Grid Background="Black">
            <Grid VerticalAlignment="Top" Height="20" Margin="5 5">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="7*"/>
                    <ColumnDefinition Width="1*"/>
                </Grid.ColumnDefinitions>
                <Border CornerRadius="8 8 3 3">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="40"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <Path Fill="AliceBlue" Height="15" Width="15" Stretch="Fill" Margin="20 0 0 0"
                                Data="M55.146,51.887L41.588,37.786c3.486-4.144,5.396-9.358,5.396-14.786c0-12.682-10.318-23-23-23s-23,10.318-23,23
	                        s10.318,23,23,23c4.761,0,9.298-1.436,13.177-4.162l13.661,14.208c0.571,0.593,1.339,0.92,2.162,0.92
	                        c0.779,0,1.518-0.297,2.079-0.837C56.255,54.982,56.293,53.08,55.146,51.887z M23.984,6c9.374,0,17,7.626,17,17s-7.626,17-17,17
	                        s-17-7.626-17-17S14.61,6,23.984,6z" />
                        <TextBox Grid.Column="1" x:Name="BarreRecherche" TextChanged="barreRecherche"
                                 Template="{StaticResource TextBoxRecherche}" Margin="20 0 0 0"/>
                    </Grid>
                </Border>
            </Grid>
            
            <Grid VerticalAlignment="Top" Height="60" Margin="0 30">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <usersControls:UCPathButton MaxWidth="25" MaxHeight="20" x:Name="Bouton1" MouseLeftButtonDown="BoutonTriAlphabetique" Path="M286.935,69.377c-3.614-3.617-7.898-5.424-12.848-5.424H18.274c-4.952,0-9.233,1.807-12.85,5.424 C1.807,72.998,0,77.279,0,82.228c0,4.948,1.807,9.229,5.424,12.847l127.907,127.907c3.621,3.617,7.902,5.428,12.85,5.428  s9.233-1.811,12.847-5.428L286.935,95.074c3.613-3.617,5.427-7.898,5.427-12.847C292.362,77.279,290.548,72.998,286.935,69.377z"/>
                <usersControls:UCPathButton MaxWidth="30" MaxHeight="30" Grid.Column="1" x:Name="Bouton2" MouseLeftButtonDown="BoutonFiltreFavori" Path="m256 455.515625c-7.289062 0-14.316406-2.640625-19.792969-7.4375-20.683593-18.085937-40.625-35.082031-58.21875-50.074219l-.089843-.078125c-51.582032-43.957031-96.125-81.917969-127.117188-119.3125-34.644531-41.804687-50.78125-81.441406-50.78125-124.742187 0-42.070313 14.425781-80.882813 40.617188-109.292969 26.503906-28.746094 62.871093-44.578125 102.414062-44.578125 29.554688 0 56.621094 9.34375 80.445312 27.769531 12.023438 9.300781 22.921876 20.683594 32.523438 33.960938 9.605469-13.277344 20.5-24.660157 32.527344-33.960938 23.824218-18.425781 50.890625-27.769531 80.445312-27.769531 39.539063 0 75.910156 15.832031 102.414063 44.578125 26.191406 28.410156 40.613281 67.222656 40.613281 109.292969 0 43.300781-16.132812 82.9375-50.777344 124.738281-30.992187 37.398437-75.53125 75.355469-127.105468 119.308594-17.625 15.015625-37.597657 32.039062-58.328126 50.167969-5.472656 4.789062-12.503906 7.429687-19.789062 7.429687zm-112.96875-425.523437c-31.066406 0-59.605469 12.398437-80.367188 34.914062-21.070312 22.855469-32.675781 54.449219-32.675781 88.964844 0 36.417968 13.535157 68.988281 43.882813 105.605468 29.332031 35.394532 72.960937 72.574219 123.476562 115.625l.09375.078126c17.660156 15.050781 37.679688 32.113281 58.515625 50.332031 20.960938-18.253907 41.011719-35.34375 58.707031-50.417969 50.511719-43.050781 94.136719-80.222656 123.46875-115.617188 30.34375-36.617187 43.878907-69.1875 43.878907-105.605468 0-34.515625-11.605469-66.109375-32.675781-88.964844-20.757813-22.515625-49.300782-34.914062-80.363282-34.914062-22.757812 0-43.652344 7.234374-62.101562 21.5-16.441406 12.71875-27.894532 28.796874-34.609375 40.046874-3.453125 5.785157-9.53125 9.238282-16.261719 9.238282s-12.808594-3.453125-16.261719-9.238282c-6.710937-11.25-18.164062-27.328124-34.609375-40.046874-18.449218-14.265626-39.34375-21.5-62.097656-21.5zm0 0"/>
                <Button Click="BoutonFiltrePersonnalisation" Grid.Column="2" MouseEnter="SurvolBouton" MouseLeave="FinSurvolBouton">
                    <Button.Content>
                        <TextBlock Text="Tous les astres" Style="{StaticResource texteInfosAstre}" x:Name="Bouton3" 
                                   TextWrapping="Wrap"/>
                    </Button.Content>
                </Button>
                <Button Click="BoutonFiltreType" Grid.Column="3" MouseEnter="SurvolBouton" MouseLeave="FinSurvolBouton">
                    <Button.Content>
                        <Image Source="/images/icones/tousLesAstres.png" x:Name="Bouton4" MaxWidth="40"/>
                    </Button.Content>
                </Button>
            </Grid>
        </Grid>
        
        <ListBox ItemsSource="{Binding LesAstresTries}" SelectedValue="{Binding AstreSelectionne, Mode=TwoWay}" 
            Background="#181818" Margin="0,90,0,0" BorderThickness="0 2 0 0" BorderBrush="AliceBlue">
            <ListBox.ItemContainerStyle>
                <Style TargetType="ListBoxItem">
                    <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                </Style>
            </ListBox.ItemContainerStyle>
        </ListBox>

            <Image Source="images/fonds/fondCarte1.jpg" Grid.Column="1" Stretch="UniformToFill"/>
        <ItemsControl ItemsSource="{Binding Carte.LesAstres}" Grid.Column="1">
            <ItemsControl.ItemsPanel>
                <ItemsPanelTemplate>
                    <Canvas MouseLeftButtonDown="ClicSourisCanvas" Background="Transparent" Grid.Column="1"/>
                </ItemsPanelTemplate>
            </ItemsControl.ItemsPanel>
            <ItemsControl.ItemContainerStyle>
                <Style>
                    <Setter Property="Canvas.Left" Value="{Binding Key.X}"/>
                    <Setter Property="Canvas.Top" Value="{Binding Key.Y}"/>
                </Style>
            </ItemsControl.ItemContainerStyle>
            <ItemsControl.ItemTemplate>
                <DataTemplate>
					<Ellipse Stroke="Black" Fill="Yellow" Height="15" Width="15" Panel.ZIndex="50" 
                             MouseLeftButtonDown="PointClique" MouseEnter="SurvolBouton" MouseLeave="FinSurvolBouton"/>                
                </DataTemplate>
            </ItemsControl.ItemTemplate>
        </ItemsControl>

        <usersControls:UCPathButton Grid.Column="1" 
                                    VerticalAlignment="Top" 
                                    HorizontalAlignment="Right" 
                                    Width="30" 
                                    Height="25" 
                                    Margin="0 10 10 0" 
                                    MouseLeftButtonDown="SpecClic" 
                                    x:Name="SpecBouton"/>

        <usersControls:UCPathButton Background="Transparent" 
                                    Grid.Column="1" VerticalAlignment="Bottom" 
                                    HorizontalAlignment="Right" 
                                    Width="25" Height="40" 
                                    Margin="0 0 10 10" 
                                    MouseLeftButtonDown="PoubelleClic" 
                                    x:Name="Poubelle"
                                    Path="m424 64h-88v-16c0-26.467-21.533-48-48-48h-64c-26.467 0-48 21.533-48 48v16h-88c-22.056 0-40 17.944-40 40v56c0 8.836 7.164 16 16 16h8.744l13.823 290.283c1.221 25.636 22.281 45.717 47.945 45.717h242.976c25.665 0 46.725-20.081 47.945-45.717l13.823-290.283h8.744c8.836 0 16-7.164 16-16v-56c0-22.056-17.944-40-40-40zm-216-16c0-8.822 7.178-16 16-16h64c8.822 0 16 7.178 16 16v16h-96zm-128 56c0-4.411 3.589-8 8-8h336c4.411 0 8 3.589 8 8v40c-4.931 0-331.567 0-352 0zm313.469 360.761c-.407 8.545-7.427 15.239-15.981 15.239h-242.976c-8.555 0-15.575-6.694-15.981-15.239l-13.751-288.761h302.44z"/>
        
        <ContentControl  Grid.Column="1" x:Name="Popup" Content="{Binding AstreSelectionne}">
            <ContentControl.ContentTemplate>
                <DataTemplate>
                    <usersControls:UCPopup ImageAstre="{Binding Image}"
                                           NomAstre="{Binding Nom}"
                                           DescriptionAstre="{Binding Description}"
                                           AgeAstre="{Binding Age}"
                                           MasseAstre="{Binding Masse}"
                                           TemperatureAstre="{Binding Temperature}"/>
                </DataTemplate>
            </ContentControl.ContentTemplate>
        </ContentControl>
    </Grid>
</Window>
